var Unicorn=function(exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function isEmpty(obj){return void 0===obj||0===Object.keys(obj).length&&obj.constructor===Object}function contains(str,search){return str.indexOf(search)>-1}function debounce(func,wait,immediate){var timeout,_this=this;return void 0===immediate&&(immediate=!0),function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var context=_this,later=function(){timeout=null,immediate||func.apply(context,args)},callNow=immediate&&!timeout;clearTimeout(timeout),timeout=setTimeout(later,wait),callNow&&func.apply(context,args)}}var range,Attribute=function(){function Attribute(attribute){_classCallCheck(this,Attribute),this.attribute=attribute,this.name=this.attribute.name,this.value=this.attribute.value,this.isUnicorn=!1,this.isModel=!1,this.isPoll=!1,this.isKey=!1,this.isError=!1,this.modifiers={},this.eventType=null,this.init()}return _createClass(Attribute,[{key:"init",value:function(){var _this=this;if(contains(this.name,"unicorn:")){if(this.isUnicorn=!0,contains(this.name,"unicorn:model"))this.isModel=!0;else if(contains(this.name,"unicorn:poll"))this.isPoll=!0;else if("unicorn:key"===this.name)this.isKey=!0;else if(contains(this.name,"unicorn:error:"))this.isError=!0;else{var actionEventType=this.name.replace("unicorn:","");"id"!==actionEventType&&"name"!==actionEventType&&"checksum"!==actionEventType&&(this.eventType=actionEventType)}var potentialModifiers=this.name;this.eventType&&(potentialModifiers=this.eventType),potentialModifiers.split(".").slice(1).forEach((function(modifier){var modifierArgs=modifier.split("-");_this.modifiers[modifierArgs[0]]=!(modifierArgs.length>1)||modifierArgs[1]}))}}}]),Attribute}(),Element=function(){function Element(el){_classCallCheck(this,Element),this.el=el,this.init()}return _createClass(Element,[{key:"init",value:function(){if(this.id=this.el.id,this.isUnicorn=!1,this.attributes=[],this.value=this.getValue(),this.model={},this.poll={},this.action={},this.key=void 0,this.errors=[],this.el.attributes)for(var i=0;i<this.el.attributes.length;i++){var attribute=new Attribute(this.el.attributes[i]);if(this.attributes.push(attribute),attribute.isUnicorn&&(this.isUnicorn=!0),attribute.isModel?(this.model.name=attribute.value,this.model.eventType=attribute.modifiers.lazy?"blur":"input",this.model.isLazy=!!attribute.modifiers.lazy,this.model.debounceTime=attribute.modifiers.debounce&&parseInt(attribute.modifiers.debounce,10)||-1):attribute.isPoll?(this.poll.method=attribute.value?attribute.value:"refresh",this.poll.timing=parseInt(Object.keys(attribute.modifiers)[0],10)||2e3):attribute.eventType&&(this.action.name=attribute.value,this.action.eventType=attribute.eventType,attribute.modifiers&&(this.action.key=Object.keys(attribute.modifiers)[0]),this.action.key&&(this.action.eventType=this.action.eventType.replace(".".concat(this.action.key),""))),attribute.isKey&&(this.key=attribute.value),attribute.isError){var code=attribute.name.replace("unicorn:name:","");this.errors.push({code:code,message:attribute.value})}}}},{key:"focus",value:function(){this.el.focus()}},{key:"getValue",value:function(){var value=this.el.value;if(this.el.type)if("checkbox"===this.el.type.toLowerCase())value=this.el.checked;else if("select-multiple"===this.el.type.toLowerCase()){value=[];for(var i=0;i<this.el.selectedOptions.length;i++)value.push(this.el.selectedOptions[i].value)}return value}},{key:"setValue",value:function(val){"radio"===this.el.type.toLowerCase()?this.el.value===val&&(this.el.checked=!0):"checkbox"===this.el.type.toLowerCase()?this.el.checked=val:this.el.value=val}},{key:"addError",value:function(error){this.errors.push(error),this.el.setAttribute("unicorn:error:".concat(error.code),error.message)}},{key:"removeErrors",value:function(){var _this=this;this.errors.forEach((function(error){_this.el.removeAttribute(error.code)})),this.errors=[]}}]),Element}();var doc="undefined"==typeof document?void 0:document,HAS_TEMPLATE_SUPPORT=!!doc&&"content"in doc.createElement("template"),HAS_RANGE_SUPPORT=!!doc&&doc.createRange&&"createContextualFragment"in doc.createRange();function toElement(str){return str=str.trim(),HAS_TEMPLATE_SUPPORT?function(str){var template=doc.createElement("template");return template.innerHTML=str,template.content.childNodes[0]}(str):HAS_RANGE_SUPPORT?function(str){return range||(range=doc.createRange()).selectNode(doc.body),range.createContextualFragment(str).childNodes[0]}(str):function(str){var fragment=doc.createElement("body");return fragment.innerHTML=str,fragment.childNodes[0]}(str)}function compareNodeNames(fromEl,toEl){var fromCodeStart,toCodeStart,fromNodeName=fromEl.nodeName,toNodeName=toEl.nodeName;return fromNodeName===toNodeName||(fromCodeStart=fromNodeName.charCodeAt(0),toCodeStart=toNodeName.charCodeAt(0),fromCodeStart<=90&&toCodeStart>=97?fromNodeName===toNodeName.toUpperCase():toCodeStart<=90&&fromCodeStart>=97&&toNodeName===fromNodeName.toUpperCase())}function syncBooleanAttrProp(fromEl,toEl,name){fromEl[name]!==toEl[name]&&(fromEl[name]=toEl[name],fromEl[name]?fromEl.setAttribute(name,""):fromEl.removeAttribute(name))}var specialElHandlers={OPTION:function(fromEl,toEl){var parentNode=fromEl.parentNode;if(parentNode){var parentName=parentNode.nodeName.toUpperCase();"OPTGROUP"===parentName&&(parentName=(parentNode=parentNode.parentNode)&&parentNode.nodeName.toUpperCase()),"SELECT"!==parentName||parentNode.hasAttribute("multiple")||(fromEl.hasAttribute("selected")&&!toEl.selected&&(fromEl.setAttribute("selected","selected"),fromEl.removeAttribute("selected")),parentNode.selectedIndex=-1)}syncBooleanAttrProp(fromEl,toEl,"selected")},INPUT:function(fromEl,toEl){syncBooleanAttrProp(fromEl,toEl,"checked"),syncBooleanAttrProp(fromEl,toEl,"disabled"),fromEl.value!==toEl.value&&(fromEl.value=toEl.value),toEl.hasAttribute("value")||fromEl.removeAttribute("value")},TEXTAREA:function(fromEl,toEl){var newValue=toEl.value;fromEl.value!==newValue&&(fromEl.value=newValue);var firstChild=fromEl.firstChild;if(firstChild){var oldValue=firstChild.nodeValue;if(oldValue==newValue||!newValue&&oldValue==fromEl.placeholder)return;firstChild.nodeValue=newValue}},SELECT:function(fromEl,toEl){if(!toEl.hasAttribute("multiple")){for(var optgroup,nodeName,selectedIndex=-1,i=0,curChild=fromEl.firstChild;curChild;)if("OPTGROUP"===(nodeName=curChild.nodeName&&curChild.nodeName.toUpperCase()))curChild=(optgroup=curChild).firstChild;else{if("OPTION"===nodeName){if(curChild.hasAttribute("selected")){selectedIndex=i;break}i++}!(curChild=curChild.nextSibling)&&optgroup&&(curChild=optgroup.nextSibling,optgroup=null)}fromEl.selectedIndex=selectedIndex}}};function noop(){}function defaultGetNodeKey(node){if(node)return node.getAttribute&&node.getAttribute("id")||node.id}var morphdom=function(morphAttrs){return function(fromNode,toNode,options){if(options||(options={}),"string"==typeof toNode)if("#document"===fromNode.nodeName||"HTML"===fromNode.nodeName||"BODY"===fromNode.nodeName){var toNodeHtml=toNode;(toNode=doc.createElement("html")).innerHTML=toNodeHtml}else toNode=toElement(toNode);var getNodeKey=options.getNodeKey||defaultGetNodeKey,onBeforeNodeAdded=options.onBeforeNodeAdded||noop,onNodeAdded=options.onNodeAdded||noop,onBeforeElUpdated=options.onBeforeElUpdated||noop,onElUpdated=options.onElUpdated||noop,onBeforeNodeDiscarded=options.onBeforeNodeDiscarded||noop,onNodeDiscarded=options.onNodeDiscarded||noop,onBeforeElChildrenUpdated=options.onBeforeElChildrenUpdated||noop,childrenOnly=!0===options.childrenOnly,fromNodesLookup=Object.create(null),keyedRemovalList=[];function addKeyedRemoval(key){keyedRemovalList.push(key)}function walkDiscardedChildNodes(node,skipKeyedNodes){if(1===node.nodeType)for(var curChild=node.firstChild;curChild;){var key=void 0;skipKeyedNodes&&(key=getNodeKey(curChild))?addKeyedRemoval(key):(onNodeDiscarded(curChild),curChild.firstChild&&walkDiscardedChildNodes(curChild,skipKeyedNodes)),curChild=curChild.nextSibling}}function removeNode(node,parentNode,skipKeyedNodes){!1!==onBeforeNodeDiscarded(node)&&(parentNode&&parentNode.removeChild(node),onNodeDiscarded(node),walkDiscardedChildNodes(node,skipKeyedNodes))}function handleNodeAdded(el){onNodeAdded(el);for(var curChild=el.firstChild;curChild;){var nextSibling=curChild.nextSibling,key=getNodeKey(curChild);if(key){var unmatchedFromEl=fromNodesLookup[key];unmatchedFromEl&&compareNodeNames(curChild,unmatchedFromEl)?(curChild.parentNode.replaceChild(unmatchedFromEl,curChild),morphEl(unmatchedFromEl,curChild)):handleNodeAdded(curChild)}else handleNodeAdded(curChild);curChild=nextSibling}}function morphEl(fromEl,toEl,childrenOnly){var toElKey=getNodeKey(toEl);if(toElKey&&delete fromNodesLookup[toElKey],!childrenOnly){if(!1===onBeforeElUpdated(fromEl,toEl))return;if(morphAttrs(fromEl,toEl),onElUpdated(fromEl),!1===onBeforeElChildrenUpdated(fromEl,toEl))return}"TEXTAREA"!==fromEl.nodeName?function(fromEl,toEl){var curToNodeKey,curFromNodeKey,fromNextSibling,toNextSibling,matchingFromEl,curToNodeChild=toEl.firstChild,curFromNodeChild=fromEl.firstChild;outer:for(;curToNodeChild;){for(toNextSibling=curToNodeChild.nextSibling,curToNodeKey=getNodeKey(curToNodeChild);curFromNodeChild;){if(fromNextSibling=curFromNodeChild.nextSibling,curToNodeChild.isSameNode&&curToNodeChild.isSameNode(curFromNodeChild)){curToNodeChild=toNextSibling,curFromNodeChild=fromNextSibling;continue outer}curFromNodeKey=getNodeKey(curFromNodeChild);var curFromNodeType=curFromNodeChild.nodeType,isCompatible=void 0;if(curFromNodeType===curToNodeChild.nodeType&&(1===curFromNodeType?(curToNodeKey?curToNodeKey!==curFromNodeKey&&((matchingFromEl=fromNodesLookup[curToNodeKey])?fromNextSibling===matchingFromEl?isCompatible=!1:(fromEl.insertBefore(matchingFromEl,curFromNodeChild),curFromNodeKey?addKeyedRemoval(curFromNodeKey):removeNode(curFromNodeChild,fromEl,!0),curFromNodeChild=matchingFromEl):isCompatible=!1):curFromNodeKey&&(isCompatible=!1),(isCompatible=!1!==isCompatible&&compareNodeNames(curFromNodeChild,curToNodeChild))&&morphEl(curFromNodeChild,curToNodeChild)):3!==curFromNodeType&&8!=curFromNodeType||(isCompatible=!0,curFromNodeChild.nodeValue!==curToNodeChild.nodeValue&&(curFromNodeChild.nodeValue=curToNodeChild.nodeValue))),isCompatible){curToNodeChild=toNextSibling,curFromNodeChild=fromNextSibling;continue outer}curFromNodeKey?addKeyedRemoval(curFromNodeKey):removeNode(curFromNodeChild,fromEl,!0),curFromNodeChild=fromNextSibling}if(curToNodeKey&&(matchingFromEl=fromNodesLookup[curToNodeKey])&&compareNodeNames(matchingFromEl,curToNodeChild))fromEl.appendChild(matchingFromEl),morphEl(matchingFromEl,curToNodeChild);else{var onBeforeNodeAddedResult=onBeforeNodeAdded(curToNodeChild);!1!==onBeforeNodeAddedResult&&(onBeforeNodeAddedResult&&(curToNodeChild=onBeforeNodeAddedResult),curToNodeChild.actualize&&(curToNodeChild=curToNodeChild.actualize(fromEl.ownerDocument||doc)),fromEl.appendChild(curToNodeChild),handleNodeAdded(curToNodeChild))}curToNodeChild=toNextSibling,curFromNodeChild=fromNextSibling}!function(fromEl,curFromNodeChild,curFromNodeKey){for(;curFromNodeChild;){var fromNextSibling=curFromNodeChild.nextSibling;(curFromNodeKey=getNodeKey(curFromNodeChild))?addKeyedRemoval(curFromNodeKey):removeNode(curFromNodeChild,fromEl,!0),curFromNodeChild=fromNextSibling}}(fromEl,curFromNodeChild,curFromNodeKey);var specialElHandler=specialElHandlers[fromEl.nodeName];specialElHandler&&specialElHandler(fromEl,toEl)}(fromEl,toEl):fromEl.innerHTML!=toEl.innerHTML&&specialElHandlers.TEXTAREA(fromEl,toEl)}!function indexTree(node){if(1===node.nodeType||11===node.nodeType)for(var curChild=node.firstChild;curChild;){var key=getNodeKey(curChild);key&&(fromNodesLookup[key]=curChild),indexTree(curChild),curChild=curChild.nextSibling}}(fromNode);var name,namespaceURI,morphedNode=fromNode,morphedNodeType=morphedNode.nodeType,toNodeType=toNode.nodeType;if(!childrenOnly)if(1===morphedNodeType)1===toNodeType?compareNodeNames(fromNode,toNode)||(onNodeDiscarded(fromNode),morphedNode=function(fromEl,toEl){for(var curChild=fromEl.firstChild;curChild;){var nextChild=curChild.nextSibling;toEl.appendChild(curChild),curChild=nextChild}return toEl}(fromNode,(name=toNode.nodeName,(namespaceURI=toNode.namespaceURI)&&"http://www.w3.org/1999/xhtml"!==namespaceURI?doc.createElementNS(namespaceURI,name):doc.createElement(name)))):morphedNode=toNode;else if(3===morphedNodeType||8===morphedNodeType){if(toNodeType===morphedNodeType)return morphedNode.nodeValue!==toNode.nodeValue&&(morphedNode.nodeValue=toNode.nodeValue),morphedNode;morphedNode=toNode}if(morphedNode===toNode)onNodeDiscarded(fromNode);else{if(toNode.isSameNode&&toNode.isSameNode(morphedNode))return;if(morphEl(morphedNode,toNode,childrenOnly),keyedRemovalList)for(var i=0,len=keyedRemovalList.length;i<len;i++){var elToRemove=fromNodesLookup[keyedRemovalList[i]];elToRemove&&removeNode(elToRemove,elToRemove.parentNode,!1)}}return!childrenOnly&&morphedNode!==fromNode&&fromNode.parentNode&&(morphedNode.actualize&&(morphedNode=morphedNode.actualize(fromNode.ownerDocument||doc)),fromNode.parentNode.replaceChild(morphedNode,fromNode)),morphedNode}}((function(fromNode,toNode){var attr,attrName,attrNamespaceURI,attrValue,toNodeAttrs=toNode.attributes;if(11!==toNode.nodeType&&11!==fromNode.nodeType){for(var i=toNodeAttrs.length-1;i>=0;i--)attrName=(attr=toNodeAttrs[i]).name,attrNamespaceURI=attr.namespaceURI,attrValue=attr.value,attrNamespaceURI?(attrName=attr.localName||attrName,fromNode.getAttributeNS(attrNamespaceURI,attrName)!==attrValue&&("xmlns"===attr.prefix&&(attrName=attr.name),fromNode.setAttributeNS(attrNamespaceURI,attrName,attrValue))):fromNode.getAttribute(attrName)!==attrValue&&fromNode.setAttribute(attrName,attrValue);for(var fromNodeAttrs=fromNode.attributes,d=fromNodeAttrs.length-1;d>=0;d--)attrName=(attr=fromNodeAttrs[d]).name,(attrNamespaceURI=attr.namespaceURI)?(attrName=attr.localName||attrName,toNode.hasAttributeNS(attrNamespaceURI,attrName)||fromNode.removeAttributeNS(attrNamespaceURI,attrName)):toNode.hasAttribute(attrName)||fromNode.removeAttribute(attrName)}})),Component=function(){function Component(args){if(_classCallCheck(this,Component),this.id=args.id,this.name=args.name,this.messageUrl=args.messageUrl,this.csrfTokenHeaderName=args.csrfTokenHeaderName,contains(this.name,".")){var names=this.name.split(".");this.name=names[names.length-2]}this.data=args.data,this.syncUrl="".concat(this.messageUrl,"/").concat(this.name),this.root=void 0,this.modelEls=[],this.errors={},this.poll={},this.actionQueue=[],this.currentActionQueue=null,this.actionEvents={},this.attachedEventTypes=[],this.init(),this.refreshEventListeners(),this.initPolling()}return _createClass(Component,[{key:"init",value:function(){var selector,scope;if(this.root=(selector='[unicorn\\:id="'.concat(this.id,'"]'),void 0===scope&&(scope=document),scope.querySelector(selector)),!this.root)throw Error("No id found");this.refreshChecksum()}},{key:"addActionEventListener",value:function(eventType){var _this=this;document.addEventListener(eventType,(function(event){var targetElement=new Element(event.target);targetElement&&targetElement.isUnicorn&&!isEmpty(targetElement.action)&&_this.actionEvents[eventType].forEach((function(element){if(targetElement.el.isSameNode(element.el)){if(!isEmpty(targetElement.model)&&targetElement.model.isLazy){var action={type:"syncInput",payload:{name:targetElement.model.name,value:targetElement.getValue()}};_this.actionQueue.push(action)}element.action.key?element.action.key===event.key.match(/[A-Z]{2,}(?=[A-Z][a-z]+[0-9]*|\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g).map((function(x){return x.toLowerCase()})).join("-")&&_this.callMethod(element.action.name):_this.callMethod(element.action.name)}}))}))}},{key:"addModelEventListener",value:function(element,eventType){var _this2=this;element.el.addEventListener(eventType,(function(){var action={type:"syncInput",payload:{name:element.model.name,value:element.getValue()}};_this2.actionQueue.push(action),_this2.sendMessage(element.model.debounceTime,(function(excludeElement,err){err?console.error(err):excludeElement?_this2.setModelValues(element):_this2.setModelValues()}))}))}},{key:"refreshEventListeners",value:function(){var _this3=this;this.actionEvents={},function(el,callback){for(var walker=document.createTreeWalker(el,NodeFilter.SHOW_ELEMENT,null,!1);walker.nextNode();)callback(walker.currentNode)}(this.root,(function(el){if(!el.isSameNode(_this3.root)){var element=new Element(el);element.isUnicorn&&(isEmpty(element.model)||0===_this3.modelEls.filter((function(m){return m.el.isSameNode(element.el)})).length&&(_this3.modelEls.push(element),_this3.addModelEventListener(element,element.model.eventType)),isEmpty(element.action)||(_this3.actionEvents[element.action.eventType]?_this3.actionEvents[element.action.eventType].push(element):(_this3.actionEvents[element.action.eventType]=[element],0===_this3.attachedEventTypes.filter((function(et){return et===element.action.eventType})).length&&(_this3.attachedEventTypes.push(element.action.eventType),_this3.addActionEventListener(element.action.eventType)))))}}))}},{key:"callMethod",value:function(methodName,errCallback){var _this4=this,action={type:"callMethod",payload:{name:methodName,params:[]}};this.actionQueue.push(action),this.sendMessage(-1,(function(_,err){err&&"function"==typeof errCallback?errCallback(err):err?console.error(err):_this4.setModelValues()}))}},{key:"initPolling",value:function(){var _this5=this,rootElement=new Element(this.root);rootElement.isUnicorn&&!isEmpty(rootElement.poll)&&(this.poll=rootElement.poll,this.poll.timer=null,document.addEventListener("visibilitychange",(function(){document.hidden?_this5.poll.timer&&clearInterval(_this5.poll.timer):_this5.startPolling()}),!1),this.startPolling())}},{key:"startPolling",value:function(){function handleError(err){err&&console.error(err),this.poll.timer&&clearInterval(this.poll.timer)}this.poll.timer=null,this.callMethod(this.poll.method,handleError),this.poll.timer=setInterval(this.callMethod.bind(this),this.poll.timing,this.poll.method,handleError)}},{key:"refreshChecksum",value:function(){this.checksum=this.root.getAttribute("unicorn:checksum")}},{key:"setValue",value:function(element){for(var modelNamePieces=element.model.name.split("."),_data=this.data,i=0;i<modelNamePieces.length;i++){var modelNamePiece=modelNamePieces[i];Object.prototype.hasOwnProperty.call(_data,modelNamePiece)&&(i===modelNamePieces.length-1?element.setValue(_data[modelNamePiece]):_data=_data[modelNamePiece])}}},{key:"setModelValues",value:function(elementToExclude){var _this6=this,elementFocused=!1;isEmpty(elementToExclude=elementToExclude||{})||elementToExclude.model.isLazy||["id","key"].forEach((function(attr){_this6.modelEls.forEach((function(element){elementFocused||elementToExclude[attr]&&elementToExclude[attr]===element[attr]&&(element.focus(),elementFocused=!0)}))})),this.modelEls.forEach((function(element){element.id===elementToExclude.id&&element.key===elementToExclude.key||_this6.setValue(element)}))}},{key:"sendMessage",value:function(debounceTime,callback){function _sendMessage(_component){if(0!==_component.actionQueue.length&&_component.currentActionQueue!==_component.actionQueue){_component.currentActionQueue=_component.actionQueue,_component.actionQueue=[];var body={id:_component.id,data:_component.data,checksum:_component.checksum,actionQueue:_component.currentActionQueue},headers={Accept:"application/json","X-Requested-With":"XMLHttpRequest"};headers[_component.csrfTokenHeaderName]=function(){var csrfTokenCookie=document.cookie.split(";").filter((function(item){return item.trim().startsWith("csrftoken=")}));if(csrfTokenCookie.length>0)return csrfTokenCookie[0].replace("csrftoken=","");var csrfElements=document.getElementsByName("csrfmiddlewaretoken");if(csrfElements&&csrfElements.length>0)return csrfElements[0].getAttribute("value");throw Error("CSRF token is missing. Do you need to add {% csrf_token %}?")}(),fetch(_component.syncUrl,{method:"POST",headers:headers,body:JSON.stringify(body)}).then((function(response){if(response.ok)return response.json();throw Error("Error when getting response: ".concat(response.statusText," (").concat(response.status,")"))})).then((function(responseJson){if(responseJson){if(responseJson.error)throw Error(responseJson.error);_component.modelEls.forEach((function(element){element.init(),element.removeErrors()})),_component.data=responseJson.data||{},_component.errors=responseJson.errors||{};var rerenderedComponent=responseJson.dom;morphdom(_component.root,rerenderedComponent,{childrenOnly:!1,getNodeKey:function(node){if(node.attributes){var key=node.getAttribute("unicorn:key")||node.id;if(key)return key}},onBeforeElUpdated:function(fromEl,toEl){if(fromEl.isEqualNode(toEl))return!1}}),_component.refreshChecksum(),_component.refreshEventListeners(),_component.modelEls.forEach((function(element){Object.keys(_component.errors).forEach((function(modelName){if(element.model.name===modelName){var error=_component.errors[modelName][0];element.addError(error)}}))}));var hasCallMethod=!1;_component.currentActionQueue.forEach((function(action){"callMethod"===action.type&&(hasCallMethod=!0)})),_component.currentActionQueue=null,callback&&"function"==typeof callback&&callback(!hasCallMethod,null)}})).catch((function(err){_component.actionQueue=[],_component.currentActionQueue=null,callback&&"function"==typeof callback&&callback(null,err)}))}}-1===debounceTime?debounce(_sendMessage,250,!1)(this):debounce(_sendMessage,debounceTime,!1)(this)}}]),Component}(),messageUrl="",components={};return exports.call=function(componentName,methodName){var component;if(Object.keys(components).forEach((function(id){if(void 0===component){var _component=components[id];_component.name===componentName&&(component=_component)}})),!component)throw Error("No component found for: ",componentName);component.callMethod(methodName,(function(err){console.error(err)}))},exports.componentInit=function(args){args.messageUrl=messageUrl,args.csrfTokenHeaderName="X-CSRFToken";var component=new Component(args);component.init(),components[component.id]=component,component.setModelValues()},exports.init=function(_messageUrl){messageUrl=_messageUrl},exports}({});
