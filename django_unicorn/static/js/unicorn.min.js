"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var Unicorn=function(){var s={},p="",m="X-CSRFToken",v={};function a(e){for(var t=0;t<e.attributes.length;t++){var n=e.attributes[t];if(-1<n.name.indexOf("unicorn:model"))return e.getAttribute(n.name)}}function u(e,t){for(var n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,null,!1);n.nextNode();)t(n.currentNode)}function y(e,n){void 0!==n&&n||(n={}),e.forEach(function(e){var t=e.getAttribute("unicorn:key");e.id==n.id&&t==n.key||function(e,t){for(var n=t.split("."),o=v,r=0;r<n.length;r++){var i=n[r];o.hasOwnProperty(i)&&(r==n.length-1?"radio"===e.type.toLowerCase()?e.value==o[i]&&(e.checked=!0):"checkbox"===e.type.toLowerCase()?e.checked=o[i]:e.value=o[i]:o=o[i])}}(e,a(e))})}function h(a,u,d,l,e,c){function t(){var e,t,n=p+"/"+a,o=u.getAttribute("unicorn:checksum"),r={id:d,data:v,checksum:o,actionQueue:[l]},i={Accept:"application/json","X-Requested-With":"XMLHttpRequest"};i[m]=(e="",0<(t=document.getElementsByName("csrfmiddlewaretoken")).length&&(e=t[0].getAttribute("value")),e||console.error("CSRF token is missing. Do you need to add {% csrf_token %}?"),e),fetch(n,{method:"POST",headers:i,body:JSON.stringify(r)}).then(function(e){return e.ok?e.json():void console.error("Error when getting response: "+e.statusText+" ("+e.status+")")}).then(function(e){var t;e&&(e.error?console.error(e.error):(s.setData(e.data),t=e.dom,morphdom(u,t,{childrenOnly:!1,getNodeKey:function(e){if(e.attributes){var t=e.getAttribute("unicorn:key")||e.id;if(t)return t}},onBeforeElUpdated:function(e,t){if(e.isEqualNode(t))return!1}}),c&&"function"==typeof c&&c()))})}function n(e){i=!0,o(e),setTimeout(f,r)}var o,r,i,f;-1==e?(o=t,r=250,f=function(){var e;i=!1,b.length&&(e=b.shift(),n(e))},function(e){i?b.push(e):n(e)}()):function(o,r,i){var a;null==(void 0===i?"undefined":_typeof(i))&&(i=!0);return function(){var e=this,t=arguments,n=i&&!a;clearTimeout(a),a=setTimeout(function(){a=null,i||o.apply(e,t)},r),n&&o.apply(e,t)}}(t,e)()}function d(e,t){return null==t&&(t=document),t.querySelector(e)}s.init=function(e){p=e},s.componentInit=function(e){var c=e.id,f=e.name,s=d('[unicorn\\:id="'+c+'"]');s||Error("No id found");var p=[];u(s,function(i){if(!i.isSameNode(s))for(var e=0;e<i.attributes.length;e++){var a,t,n,o,u,r,d,l=i.attributes[e];-1<l.name.indexOf("unicorn:")&&(-1<l.name.indexOf("unicorn:model")?(p.push(i),t=(a=l.name).replace("unicorn:model.","").split("."),n={},t.forEach(function(e){var t;"unicorn:model"!=e&&(t=e.split("-"),n[t[0]]=!(1<t.length)||t[1])}),o=n.lazy?"blur":"input",u=n.debounce?parseInt(n.debounce):-1,i.addEventListener(o,function(e){var t=i.getAttribute(a),n=function(e){var t=e.value;"checkbox"==e.type.toLowerCase()&&(t=e.checked);if("select-multiple"==e.type.toLowerCase()){t=[];for(var n=0;n<e.selectedOptions.length;n++)t.push(e.selectedOptions[n].value)}return t}(i),o=i.id,r=i.getAttribute("unicorn:key");h(f,s,c,{type:"syncInput",payload:{name:t,value:n}},u,function(){y(p,{id:o,key:r})})})):(r=l.name.replace("unicorn:",""),d=l.value,i.addEventListener(r,function(e){h(f,s,c,{type:"callMethod",payload:{name:d,params:[]}},0,function(){y(p)})})))}}),y(p)},s.setData=function(e){v=e},s.call=function(e,t){var n=d('[unicorn\\:name="'+e+'"]');n||Error("No component found for: ",e);var o=n.getAttribute("unicorn:id");o||Error("No id found");var r={type:"callMethod",payload:{name:t,params:[]}},i=[];u(n,function(e){e.isSameNode(n)||a(e)&&i.push(e)}),h(e,n,o,r,0,function(){y(i)})};var b=[];return s}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).morphdom=t()}(void 0,function(){var a;var x="http://www.w3.org/1999/xhtml",O="undefined"==typeof document?void 0:document,u=!!O&&"content"in O.createElement("template"),d=!!O&&O.createRange&&"createContextualFragment"in O.createRange();function k(e){return e=e.trim(),u?(n=e,(o=O.createElement("template")).innerHTML=n,o.content.childNodes[0]):d?(t=e,a||(a=O.createRange()).selectNode(O.body),a.createContextualFragment(t).childNodes[0]):(r=e,(i=O.createElement("body")).innerHTML=r,i.childNodes[0]);var t,n,o,r,i}function L(e,t){var n,o,r=e.nodeName,i=t.nodeName;return r===i||(n=r.charCodeAt(0),o=i.charCodeAt(0),n<=90&&97<=o?r===i.toUpperCase():o<=90&&97<=n&&i===r.toUpperCase())}function r(e,t,n){e[n]!==t[n]&&(e[n]=t[n],e[n]?e.setAttribute(n,""):e.removeAttribute(n))}var U,R={OPTION:function(e,t){var n,o=e.parentNode;o&&("OPTGROUP"===(n=o.nodeName.toUpperCase())&&(n=(o=o.parentNode)&&o.nodeName.toUpperCase()),"SELECT"!==n||o.hasAttribute("multiple")||(e.hasAttribute("selected")&&!t.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),o.selectedIndex=-1)),r(e,t,"selected")},INPUT:function(e,t){r(e,t,"checked"),r(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),t.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,t){var n=t.value;e.value!==n&&(e.value=n);var o=e.firstChild;if(o){var r=o.nodeValue;if(r==n||!n&&r==e.placeholder)return;o.nodeValue=n}},SELECT:function(e,t){if(!t.hasAttribute("multiple")){for(var n,o,r=-1,i=0,a=e.firstChild;a;)if("OPTGROUP"===(o=a.nodeName&&a.nodeName.toUpperCase()))a=(n=a).firstChild;else{if("OPTION"===o){if(a.hasAttribute("selected")){r=i;break}i++}!(a=a.nextSibling)&&n&&(a=n.nextSibling,n=null)}e.selectedIndex=r}}};function w(){}function I(e){if(e)return e.getAttribute&&e.getAttribute("id")||e.id}return U=function(e,t){var n,o,r,i,a=t.attributes;if(11!==t.nodeType&&11!==e.nodeType){for(var u=a.length-1;0<=u;u--)o=(n=a[u]).name,r=n.namespaceURI,i=n.value,r?(o=n.localName||o,e.getAttributeNS(r,o)!==i&&("xmlns"===n.prefix&&(o=n.name),e.setAttributeNS(r,o,i))):e.getAttribute(o)!==i&&e.setAttribute(o,i);for(var d=e.attributes,l=d.length-1;0<=l;l--)o=(n=d[l]).name,(r=n.namespaceURI)?(o=n.localName||o,t.hasAttributeNS(r,o)||e.removeAttributeNS(r,o)):t.hasAttribute(o)||e.removeAttribute(o)}},function(e,t,n){var o;n=n||{},"string"==typeof t&&("#document"===e.nodeName||"HTML"===e.nodeName||"BODY"===e.nodeName?(o=t,(t=O.createElement("html")).innerHTML=o):t=k(t));var p=n.getNodeKey||I,m=n.onBeforeNodeAdded||w,v=n.onNodeAdded||w,r=n.onBeforeElUpdated||w,i=n.onElUpdated||w,a=n.onBeforeNodeDiscarded||w,u=n.onNodeDiscarded||w,d=n.onBeforeElChildrenUpdated||w,l=!0===n.childrenOnly,y=Object.create(null),c=[];function h(e){c.push(e)}function b(e,t,n){!1!==a(e)&&(t&&t.removeChild(e),u(e),function e(t,n){if(1===t.nodeType)for(var o=t.firstChild;o;){var r=void 0;n&&(r=p(o))?h(r):(u(o),o.firstChild&&e(o,n)),o=o.nextSibling}}(e,n))}function N(e,t,n){var o=p(t);if(o&&delete y[o],!n){if(!1===r(e,t))return;if(U(e,t),i(e),!1===d(e,t))return}"TEXTAREA"!==e.nodeName?function(e,t){var n,o,r,i,a,u,d=t.firstChild,l=e.firstChild;e:for(;d;){for(i=d.nextSibling,n=p(d);l;){if(r=l.nextSibling,d.isSameNode&&d.isSameNode(l)){d=i,l=r;continue e}o=p(l);var c=l.nodeType,f=void 0;if(c===d.nodeType&&(1===c?(n?n!==o&&((a=y[n])&&r!==a?(e.insertBefore(a,l),o?h(o):b(l,e,!0),l=a):f=!1):o&&(f=!1),(f=!1!==f&&L(l,d))&&N(l,d)):3!==c&&8!=c||(f=!0,l.nodeValue!==d.nodeValue&&(l.nodeValue=d.nodeValue))),f){d=i,l=r;continue e}o?h(o):b(l,e,!0),l=r}n&&(a=y[n])&&L(a,d)?(e.appendChild(a),N(a,d)):!1!==(u=m(d))&&(u&&(d=u),d.actualize&&(d=d.actualize(e.ownerDocument||O)),e.appendChild(d),function e(t){v(t);for(var n=t.firstChild;n;){var o,r=n.nextSibling,i=p(n);i&&(o=y[i])&&L(n,o)?(n.parentNode.replaceChild(o,n),N(o,n)):e(n),n=r}}(d)),d=i,l=r}!function(e,t,n){for(;t;){var o=t.nextSibling;(n=p(t))?h(n):b(t,e,!0),t=o}}(e,l,o);var s=R[e.nodeName];s&&s(e,t)}(e,t):e.innerHTML!=t.innerHTML&&R.TEXTAREA(e,t)}!function e(t){if(1===t.nodeType||11===t.nodeType)for(var n=t.firstChild;n;){var o=p(n);o&&(y[o]=n),e(n),n=n.nextSibling}}(e);var f,s,g=e,A=g.nodeType,S=t.nodeType;if(!l)if(1===A)1===S?L(e,t)||(u(e),g=function(e,t){for(var n=e.firstChild;n;){var o=n.nextSibling;t.appendChild(n),n=o}return t}(e,(f=t.nodeName,(s=t.namespaceURI)&&s!==x?O.createElementNS(s,f):O.createElement(f)))):g=t;else if(3===A||8===A){if(S===A)return g.nodeValue!==t.nodeValue&&(g.nodeValue=t.nodeValue),g;g=t}if(g===t)u(e);else{if(t.isSameNode&&t.isSameNode(g))return;if(N(g,t,l),c)for(var T=0,C=c.length;T<C;T++){var E=y[c[T]];E&&b(E,E.parentNode,!1)}}return!l&&g!==e&&e.parentNode&&(g.actualize&&(g=g.actualize(e.ownerDocument||O)),e.parentNode.replaceChild(g,e)),g}});